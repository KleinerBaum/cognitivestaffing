# Changelog

## Unreleased

- fix: extend rule heuristics for benefits, remote policies, and required-field logging coverage
  - Fix: Regex-Heuristiken für Benefits, Remote-Modelle und Logging pflichtiger Felder erweitern
- fix: align work policy, location, contact, and benefits fields across schema, UI state, and exports
  - Fix: Arbeitsmodell-, Standort-, Kontakt- und Benefit-Felder zwischen Schema, UI-State und Exporten angleichen
- fix: treat HR contact fields as critical so wizard steps and follow-ups flag missing details consistently
  - Fix: HR-Kontaktfelder als kritisch markieren, damit Wizard-Schritte und Follow-ups fehlende Angaben zuverlässig anzeigen
- chore: remove the sidebar base-model and response-verbosity selectors in favour of automatic routing
  - Chore: Auswahlfelder für Basismodell und Antwort-Detailgrad aus der Seitenleiste entfernen und automatisches Routing nutzen
- feat: capture HR contacts, hiring managers, and qualification summaries in the vacancy extraction schema and wizard UI
  - Feature: Erfasst HR-Kontakte, Hiring-Manager:innen und Qualifikationszusammenfassungen in Schema und Wizard-Oberfläche
- feat: forward optional OpenAI organization/project IDs from env/secrets to the shared client
  - Feature: OpenAI-Organisation und -Projekt aus Umgebungsvariablen/Secrets an den gemeinsamen Client durchreichen
- feat: refactor wizard helpers into the `wizard/` package, localise follow-up presets via i18n, and load prompts from the central registry
  - Feature: Wizard-Helfer in Paket `wizard/`, Follow-up-Vorlagen lokalisiert und Prompts aus der Registry geladen
- chore: extend model fallback chains with an explicit GPT-4 hop and add bilingual deployment guidance
  - Chore: Modell-Fallbacks um einen GPT-4-Schritt erweitert und zweisprachige Deployment-Doku ergänzt
- chore: align typing/tooling configuration with Python 3.11 across mypy and developer docs
  - Chore: Typisierungs- und Tooling-Konfiguration für Python 3.11 vereinheitlicht (mypy & Entwickler-Doku)
- fix: normalise role-specific follow-up questions via translation keys instead of hard-coded English strings
  - Fix: Rollenspezifische Nachfragen per Übersetzungsschlüssel statt fest verdrahteter Englisch-Texte
- fix: keep URL text extraction functional when BeautifulSoup is unavailable by falling back to a builtin parser
  - Fix: Sichert die URL-Textextraktion ab, falls BeautifulSoup fehlt, und nutzt einen eingebauten Parser als Fallback
- fix: default the application language to English on first load
- fix: keep the wizard next button enabled and surface a hint for missing required fields
- fix: darken light-mode hero background image for stronger visual contrast
- feat: refresh onboarding hero with lighter dark-mode background, smaller logo, and mission-focused copy
- feat: retune model routing with GPT-4o/GPT-4o-mini defaults, `gpt-3.5-turbo` company extraction, updated docs, and selector tweaks (EN/DE)
  - Feature: Routing auf GPT-4o/GPT-4o-mini als Standard, `gpt-3.5-turbo` für Unternehmens-Insights sowie aktualisierte Doku und Modell-Auswahl (DE/EN)
- feat: replace sidebar salary factor table with interactive explanations and top-N selector
- feat: consolidate requirements insights into dual salary/availability cards with regional radius filtering
- feat: reorganize company step with grouped inputs for location, team context, and branding assets uploader
- feat: surface ESCO occupation multi-select after extraction and limit skill suggestions to chosen profiles
- feat: categorize ESCO skill suggestions by type and highlight outstanding essentials in wizard panels
- feat: surface ESCO occupation and essential skill pickers in wizard with sidebar todo hints
- feat: allow focus tags for skill/benefit suggestions and present grouped multi-select pickers for LLM outputs
- fix: keep wizard navigation sequential and ensure each next step scrolls to the top
- feat: detail salary fallback factors with structured deltas and localized table view
- feat: add localized overview/edit toggle to summary tabs with inline editing helpers
- feat: show summary highlights with role, company, location, salary, and skills above wizard tabs
- chore: raise OpenAI SDK floor to 1.40.0 for built-in JSON schema text.format support
- fix: adapt Responses payloads to use the ``text.format`` JSON schema config instead of ``response_format``
- feat: surface extraction confidence tiers with rule vs. AI indicators and UI legend
- chore: refresh offline ESCO cache to the v1.1.1 snapshot (2025-10-09) and document refresh cadence
- fix: enforce strict JSON schema payloads across extraction utilities
- feat: suggest HQ and contact defaults with optional autofill + rejection memory
- feat: parse benefits sections into normalized, locked compensation perks via heuristics fallback
- feat: show extraction source tooltips and AI inference indicators in wizard fields and summary tables
- feat: capture company culture, contacts, and responsibility lists in wizard company/requirements steps
- chore: add regeneration utility for need analysis schema to keep Phase fields in sync
- feat: replace sidebar hero copy with collapsible extraction overview and remove tips section
- feat: externalize salary benchmark catalog with canonical role normalization and German aliases
- feat: generate interview guide via LLM JSON schema with evaluation notes and structured fallback
- feat: refresh analysis helper datasets with IT & project-management benchmarks
- feat: refactor job ad generation to use tone-aware LLM prompts with Markdown fallback
- feat: auto-regenerate job ad and interview outputs when summary follow-up answers are applied
- feat: redesign requirements step with vertical panels and inline AI suggestions
- feat: add requirements skill market insights with salary/availability bubble chart
- fix: prevent wizard navigation deadlock when job title is missing
- feat: route CLI file extraction through ingest.extractors for OCR and text support
- fix: surface consistent OCR requirement errors when scanned PDFs lack dependencies
- fix: show user-friendly labels for missing critical fields
- fix: stack columns and buttons on small screens for mobile usability
- fix: send valid OpenAI tool definitions to avoid missing name errors
- feat: inject required arrays and nullable fields into extraction schema
- fix: map "Einsatzort"/"Branche" cues to location and industry in rule-based parsing
- fix: restore the classic "Weiter" CTA in the onboarding step with highlighted styling
- feat: add an in-house validation loop that replays extraction against NeedAnalysisProfile with graceful fallbacks
- docs: clarify Responses API migration and removal of Assistants/Threads usage
- docs: add bilingual legal information page including ESCO licensing notice
- docs: document confidence indicators and locking metadata in README and pipeline guide
- docs: expand local OCR setup instructions for CLI ingestion workflows
- fix: show localized warning in requirements step when skill suggestions fail
- fix: infer salary estimate country from primary city/HQ hints when explicit country is missing
- feat: pass primary city and required skill context to the salary estimate model payload
- feat: require explicit unlock before editing high-confidence company and job fields in the wizard
- fix: decouple job-ad brand tone widget state from company summary brand keywords syncing
- fix: prevent brand tone input normalization from mutating Streamlit widget state mid-run
- feat: polish light theme widgets with improved tabs, alerts, metrics, and dataframe styling
- feat: enrich salary fallback explanations with structured summary and adjustment rows
- fix: swap sidebar and onboarding visuals to keep Cognitive Staffing branding consistent

## v0.5 – GPT-5-Updates und RAG-Support (2025-02-18)
- docs: refresh README, agent catalog, and telemetry guides with bilingual RAG + gap-analysis instructions (EN/DE)
  - Dokumentation: aktualisiert README, Agenten-Übersicht und Telemetrie-Leitfaden mit zweisprachigen RAG- und Gap-Analyse-Hinweisen (DE/EN)
- fix: delay critical location city gating to later wizard sections so early validation only flags the company country (EN/DE)
  - Fix: verschiebt die kritische Prüfung der Stadt auf spätere Wizard-Abschnitte, damit zu Beginn nur das Unternehmensland verlangt wird (DE/EN)
- feat: auto-describe extraction tools with highlighted schema fields while keeping custom overrides for salary and other agents (EN/DE)
  - Feature: beschreibt Extraktions-Tools automatisch mit hervorgehobenen Schemafeldern und erlaubt weiter maßgeschneiderte Texte für Gehalts- oder andere Agenten (DE/EN)
- refactor: rename structured extraction handles to `NeedAnalysisProfile` and salary responses to `SalaryExpectationResponse` for consistent schema naming (EN/DE)
  - Refactor: vereinheitlicht die Funktionsnamen für strukturierte Extraktion auf `NeedAnalysisProfile` bzw. `SalaryExpectationResponse`, damit sie den Schemanamen entsprechen (DE/EN)

- feat: switch RAG embeddings to `text-embedding-3-large` (3,072-dim) and add `cli/rebuild_vector_store.py` to re-embed existing OpenAI stores (EN/DE)
  - Run `python -m cli.rebuild_vector_store <source_store_id>` and point `VECTOR_STORE_ID` to the printed target once validation passes.
  - Feature: stellt RAG-Embeddings auf `text-embedding-3-large` (3.072 Dimensionen) um und liefert `cli/rebuild_vector_store.py` zum Neu-Einbetten bestehender OpenAI-Stores (DE/EN)
  - Nach dem Lauf von `python -m cli.rebuild_vector_store <source_store_id>` die neue Store-ID in `VECTOR_STORE_ID` übernehmen.
- feat: allow opting into classic Chat Completions via `USE_CLASSIC_API` while keeping Responses as the default (EN/DE)
  - Feature: erlaubt über `USE_CLASSIC_API` den Wechsel zur klassischen Chat-Completions-API, während Responses der Standard bleibt (DE/EN)
- chore: raise OpenAI SDK minimum to 1.99.3 to stay compatible with updated Responses stream events (EN/DE)
  - Chore: hebt die Mindestversion des OpenAI-SDKs auf 1.99.3 an, um mit den aktualisierten Responses-Streaming-Ereignissen kompatibel zu bleiben (DE/EN)
- feat: re-enable ESCO occupation + essential skill seeding in follow-up question logic (EN)
  - Feature: reaktiviert ESCO-Beruf- und Kernkompetenz-Vorschläge in der Follow-up-Logik (DE)
- chore: consolidate dependency management under `requirements.txt` and drop setup-based installs (EN/DE)
  - Chore: bündelt die Abhängigkeitsverwaltung in `requirements.txt` und entfernt setup-basierte Installationen (DE/EN)
- fix: pin `streamlit-sortables` to 0.3.1 to restore deployment compatibility (EN)
  - Fix: setzt `streamlit-sortables` auf Version 0.3.1 fest, um die Bereitstellung wiederherzustellen (DE)
- docs: document the content cost router, GPT-4/GPT-3.5 fallback flow, and model override toggle (EN/DE)
  - Dokumentation: beschreibt den Content-Kostenrouter, den GPT-4/GPT-3.5-Fallback-Flow und den Modell-Override-Umschalter (DE/EN)
